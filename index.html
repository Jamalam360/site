<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#192233">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Quicksand:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Space+Mono:700" rel="stylesheet">
    <script type="text/javascript">
      var START_SEED = 5;
      var seed = START_SEED;
      var spans;
      var jumpInterval;

      function random() {
          var x = Math.sin(seed++) * 10000;
          return x - Math.floor(x);
      }

      function randomN(n) {
        return Math.floor(random() * n);
      }

      function randomChoice(alphabet) {
        return alphabet.charAt(randomN(alphabet.length));
      }

      function fillElement(elem, alphabet, density) {
        var rect = elem.getBoundingClientRect();
        var GLYPHS = rect.width * density;

        while (elem.firstChild) {
          elem.removeChild(elem.firstChild);
        }

        for (var i = 0; i < GLYPHS; i++) {
          var p = document.createElement("P");
          var t = document.createTextNode(randomChoice(alphabet));

          p.appendChild(t);
          p.className = "glyph-background";
          p.style.color = "rgba(255, 255, 255, " + random() * 0.2 + ")";
          p.style.top = (random() * rect.height * 1.3 - rect.height * 0.15) + "px";
          p.style.left = (random() * rect.width - rect.width * 0.05) + "px";
          p.style.fontSize = randomN(20) + "pt";
          p.style.transform = "rotate(" + randomN(360) + "deg)";

          elem.appendChild(p);
        }
      }

      function findTokens() {
        var token = document.getElementsByClassName('token')[0];
        var tokens = [
          "{statement -> value -> ident}",
          "{statement -> calls -> dot}",
          "{statement -> calls -> ident}",
          "{statement -> calls -> parent}",
          "{statement -> calls -> args -> int}",
          "{statement -> calls -> parent}",
          "{statement -> semicolon}"
        ];

        function addListeners(i) {
          spans[i].addEventListener("mouseover", function() {
            if (jumpInterval) window.clearInterval(jumpInterval);

            var j = i;
            token.innerHTML = tokens[j];
          });
          spans[i].addEventListener("mouseout", function() {
            token.innerHTML = "{statement}";
          });
        }

        for (var i = 0; i < spans.length; i++) {
          addListeners(i);
        }
      }

      function jump() {
        var i = Math.floor(Math.random() * spans.length);

        var span = spans[i];
        var newSpan = span.cloneNode(true);
        span.parentNode.replaceChild(newSpan, span);
        newSpan.classList.add('jump');
      }

      window.addEventListener("DOMContentLoaded", function() {
        seed = START_SEED;

        fillElement(
          document.getElementsByClassName("banner-features")[0],
          "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",
          0.2
        );
        fillElement(
          document.getElementsByClassName("banner-benchmark")[0],
          "0123456789",
          0.1
        );

        spans = document.getElementsByClassName('sample')[0].children;

        findTokens();

        jump();
        jumpInterval = setInterval(jump, 2000);

        elems = document.getElementsByClassName('chart-bar-hidden');
        elems = Array.prototype.slice.call(elems);
        startAnimations();
      }, false);

      var features = document.getElementsByClassName("banner-features")[0];
      var benchmark = document.getElementsByClassName("banner-benchmark")[0];
      var elems = [];

      function startAnimations() {
        var windowHeight = window.innerHeight;
        for (var i = 0; i < elems.length; i++) {
          var posFromTop = elems[i].getBoundingClientRect().top;
          if (posFromTop - windowHeight <= 0) {
            elems[i].className = elems[i].className.replace(
              'chart-bar-hidden',
              'chart-bar-bounce'
            );
          }
        }
      }

      window.addEventListener('scroll', startAnimations);

      window.addEventListener('resize', function() {
        seed = START_SEED;

        fillElement(
          document.getElementsByClassName("banner-features")[0],
          "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",
          0.2
        );
        fillElement(
          document.getElementsByClassName("banner-benchmark")[0],
          "0123456789",
          0.1
        );
      }, true);
    </script>
  </head>
  <body>
    <div class="container-main">
      <div class="bar-links bar-links-left">
        <div><a href="#">GitHub</a></div>
      </div>
      <div class="bar-links bar-links-right">
        <div><a href="#">Book</a></div>
        <div><a href="#">Docs</a></div>
      </div>
      <img class="logo logo-bloom" src="assets/pest-logo.svg">
      <img class="logo" src="assets/pest-logo.svg">
      <a class="button-try" href="#">Try it here!</a>
      <div class="banner-features"></div>
      <div class="features">
        <div class="illustration">
          <code class="sample">
            <span>vals</span><span>.</span><span>push</span><span>(</span><span>3</span><span>)</span><span>;</span>
          </code>
          </br>
          <code class="token">
            {statement}
          </code>
        </div>
        <h1>pest. The Elegant Parser</h1>
        <p>
          pest is a general purpose parser written in Rust with a focus on
          <strong>accessibility</strong>, <strong>correctness</strong>, and
          <strong>performance</strong>.
        </p>
        <div class="feature-grid">
          <div class="feature">
            <h2>Accessibility</h2>
            <p>
              Grammar-generated parsers are both easier to use and maintain than
              their hand-written counterparts.
            </p>
          </div class="feature">
          <div>
            <h2>Correctness</h2>
            <p>
              By leveraging Rust's memory safety guarantees, parsing will run
              within the confines of its specified grammar. Any issue will be
              fixed from there, in a declarative fashion.
            </p>
          </div>
          <div class="feature">
            <h2>Performance</h2>
            <p>
              High-level static analysis and careful low-level implementation
              ensure parsing speeds similar to highly optimized manually written
              parsers.
            </p>
          </div>
        </div>
      </div>
      <div class="banner-benchmark"></div>
      <div class="benchmark">
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut varius
          augue nec leo accumsan, quis vehicula odio suscipit. Mauris eu neque
          at augue pulvinar dignissim eget non elit. Aliquam venenatis libero
          sed tincidunt varius. Ut vitae hendrerit enim. Cras pulvinar sapien
          nulla, et condimentum ligula lacinia vitae. Cras ornare nisi ac
          hendrerit dignissim. Nunc ornare ullamcorper nisl, quis efficitur leo
          dictum at. Nulla in quam eget velit ultricies fermentum. Quisque ut
          ultrices arcu, sit amet laoreet elit. Proin ultrices egestas eleifend.
        </p>
        <div class="chart">
          <div class="chart-label"><p class="chart-label-ujson4c">ujson4c</p></div>
          <div class="chart-label"><p class="chart-label-pest">pest</p></div>
          <div class="chart-label"><p class="chart-label-pest-ast">pest AST</p></div>
          <div class="chart-label"><p class="chart-label-nom">nom</p></div>
          <div class="chart-border chart-border-1"></div>
          <div class="chart-border chart-border-2"></div>
          <div class="chart-border chart-border-3"></div>
          <div class="chart-border chart-border-4"></div>
          <div class="chart-bar chart-bar-ujson4c">
            <div class="chart-bar-hidden">
              <p>11</p>
            </div>
          </div>
          <div class="chart-bar chart-bar-pest">
            <div class="chart-bar-hidden">
              <p>18</p>
            </div>
          </div>
          <div class="chart-bar chart-bar-pest-ast">
            <div class="chart-bar-hidden">
              <p>44</p>
            </div>
          </div>
          <div class="chart-bar chart-bar-nom">
            <div class="chart-bar-hidden">
              <p>85</p>
            </div>
          </div>
          <div class="chart-value chart-value-0"><p>0ms</p></div>
          <div class="chart-value chart-value-25"><p>25ms</p></div>
          <div class="chart-value chart-value-50"><p>50ms</p></div>
          <div class="chart-value chart-value-75"><p>75ms</p></div>
        </div>
      </div>
    </div>
  </body>
</html>
